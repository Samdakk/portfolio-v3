let sectionsLoaded=0;const totalSections=6;let sectionsInitialized=!1;function checkAllSectionsLoaded(){sectionsLoaded++,sectionsLoaded>=6&&!sectionsInitialized&&(sectionsInitialized=!0,initializeAnimations())}function initializeAnimations(){"undefined"!=typeof THREE&&requestIdleCallback((()=>{initThreeJS()})),"undefined"!=typeof gsap&&"undefined"!=typeof ScrollTrigger&&requestIdleCallback((()=>{initGSAPAnimations()})),initCustomCursor(),initSkillCards()}function initThreeJS(){try{const e=new THREE.Scene,o=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),t=new THREE.WebGLRenderer({alpha:!0,antialias:!0,powerPreference:"high-performance"});t.setSize(window.innerWidth,window.innerHeight),t.setPixelRatio(Math.min(window.devicePixelRatio,2));const n=document.querySelector(".three-container");n&&n.appendChild(t.domElement);const i=new THREE.TorusKnotGeometry(10,3,100,16),r=new THREE.MeshNormalMaterial,a=new THREE.Mesh(i,r);let s,l;e.add(a),o.position.z=30,function n(){s=requestAnimationFrame(n),a.rotation.x+=.01,a.rotation.y+=.01,t.render(e,o)}(),window.addEventListener("resize",(()=>{clearTimeout(l),l=setTimeout((()=>{o.aspect=window.innerWidth/window.innerHeight,o.updateProjectionMatrix(),t.setSize(window.innerWidth,window.innerHeight),t.setPixelRatio(Math.min(window.devicePixelRatio,2))}),250)}))}catch(e){console.error("Error al inicializar Three.js:",e)}}function initGSAPAnimations(){try{gsap.registerPlugin(ScrollTrigger),gsap.utils.toArray(".section").forEach((e=>{gsap.from(e,{opacity:0,y:30,duration:.8,scrollTrigger:{trigger:e,start:"top 85%",end:"top 20%",toggleActions:"play none none reverse"}})}));const e=document.querySelectorAll(".hero-title, .hero-subtitle, .hero-button, .hero-button-outline");gsap.from(e,{opacity:0,y:30,duration:.8,stagger:.2,ease:"power2.out"})}catch(e){console.error("Error al inicializar GSAP:",e)}}function initCustomCursor(){try{const e=document.querySelector(".custom-cursor"),o=document.querySelector(".cursor-dot");if(e&&o){let t=0,n=0,i=0,r=0;document.addEventListener("mousemove",(e=>{t=e.clientX,n=e.clientY})),function a(){i+=.1*(t-i),r+=.1*(n-r),gsap.set(e,{x:i,y:r}),gsap.set(o,{x:t,y:n}),requestAnimationFrame(a)}(),document.querySelectorAll("a, button, [data-cursor-hover]").forEach((t=>{t.addEventListener("mouseenter",(()=>{e.classList.add("hover"),o.classList.add("hover")})),t.addEventListener("mouseleave",(()=>{e.classList.remove("hover"),o.classList.remove("hover")}))}))}}catch(e){console.error("Error al inicializar cursor personalizado:",e)}}function initSkillCards(){try{const e=document.querySelectorAll(".skill-flip-btn");if(!e.length)return void console.warn("No se encontraron botones de flip");e.forEach((e=>{e.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation();const o=this.closest(".skill-card");if(o)if(o.classList.toggle("flipped"),o.classList.contains("flipped")){const e=o.querySelectorAll(".progress-fill"),t=o.querySelectorAll(".skill-percentage");e.forEach(((e,o)=>{const n=e.getAttribute("data-percentage");if(!n)return;e.style.width="0%",requestAnimationFrame((()=>{e.style.width=n+"%"}));let i=0;const r=parseInt(n),a=r/62.5,s=()=>{i<r?(i+=a,t[o]&&(t[o].textContent=Math.floor(i)+"%"),requestAnimationFrame(s)):t[o]&&(t[o].textContent=r+"%")};s()}))}else{const e=o.querySelectorAll(".progress-fill"),t=o.querySelectorAll(".skill-percentage");e.forEach(((e,o)=>{e.style.width="0%",t[o]&&(t[o].textContent="0%")}))}else console.warn("No se encontró la tarjeta padre")}))}))}catch(e){console.error("Error al inicializar tarjetas de habilidades:",e)}}function initNavigation(){const e=document.querySelectorAll(".nav-link"),o=document.querySelectorAll("section"),t=new IntersectionObserver((o=>{o.forEach((o=>{if(o.isIntersecting){const n=o.target.getAttribute("id");t=n,e.forEach((e=>{e.classList.remove("active"),e.getAttribute("href")===`#${t}`&&e.classList.add("active")}))}var t}))}),{root:null,threshold:.15});o.forEach((e=>{t.observe(e)})),e.forEach((e=>{e.addEventListener("click",(o=>{o.preventDefault();const t=e.getAttribute("href"),n=document.querySelector(t);n&&window.scrollTo({top:n.offsetTop,behavior:"smooth"})}))}))}function initContactForm(){console.log("Iniciando initContactForm...");try{emailjs.init("Udxmy4j5mqzfZPWOh"),console.log("EmailJS inicializado");const e=new MutationObserver(((e,o)=>{const t=document.querySelector("#contact form");console.log("Buscando formulario...",t),t&&(console.log("Formulario encontrado, configurando..."),o.disconnect(),t.addEventListener("submit",(async function(e){console.log("Formulario enviado"),e.preventDefault();const o=this.querySelector("#name").value,t=this.querySelector("#email").value,n=this.querySelector("#message").value;if(console.log("Valores del formulario:",{name:o,email:t,message:n}),o&&t&&n)try{console.log("Enviando correo...");const e={name:o,email:t,message:n};console.log("Parámetros del correo:",e);const i=await emailjs.send("service_oj9gv7n","template_jxwbtqs",e);if(console.log("Respuesta de EmailJS:",i),200!==i.status)throw console.error("Error en la respuesta:",i),new Error("Error al enviar el mensaje");console.log("Correo enviado exitosamente"),alert("¡Mensaje enviado con éxito!"),this.reset()}catch(e){console.error("Error detallado:",e),e.text&&console.error("Mensaje de error de EmailJS:",e.text),alert("Hubo un error al enviar el mensaje. Por favor, intenta nuevamente.")}else alert("Por favor, completa todos los campos")})))}));e.observe(document.body,{childList:!0,subtree:!0});document.querySelector("#contact form")&&(console.log("Formulario encontrado inmediatamente"),e.disconnect())}catch(e){console.error("Error al inicializar el formulario de contacto:",e)}}function observeSkillsContainer(){document.getElementById("skills-container")&&setTimeout((()=>{initSkillCards()}),50)}document.addEventListener("DOMContentLoaded",(()=>{console.log("DOM cargado, inicializando..."),initNavigation(),initContactForm(),observeSkillsContainer()})),window.checkAllSectionsLoaded=checkAllSectionsLoaded,window.initializeAnimations=initializeAnimations;